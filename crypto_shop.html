<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paiement en Cryptomonnaie</title>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
</head>
<body>
    <h2>Paiement en Cryptomonnaie</h2>
    <p>Sélectionnez le produit que vous souhaitez acheter et suivez les instructions ci-dessous pour effectuer un paiement en cryptomonnaie.</p>

    <h3>Produits disponibles :</h3>
    <ul>
        <li>Sauce Piquante 1 - 0.002 ETH</li>
        <li>Sauce Piquante 2 - 0.0024 ETH</li>
        <li>Piment en Poudre - 0.0016 ETH</li>
    </ul>

    <button id="connectButton">Connecter votre Wallet</button>
    <div id="status"></div>

    <form id="paymentForm">
        <label for="product">Nom du Produit:</label><br>
        <input type="text" id="product" name="product"><br>
        <label for="amount">Montant à Envoyer (en ETH):</label><br>
        <input type="text" id="amount" name="amount"><br><br>
        <button type="button" id="payButton">Payer</button>
    </form>

    <script>
        document.getElementById('connectButton').addEventListener('click', async () => {
            if (window.ethereum) {
                window.web3 = new Web3(window.ethereum);
                try {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    document.getElementById('status').innerText = 'Wallet connecté';
                } catch (error) {
                    console.error(error);
                    document.getElementById('status').innerText = 'Connexion au wallet échouée';
                }
            } else {
                document.getElementById('status').innerText = 'MetaMask non détecté';
            }
        });

        document.getElementById('payButton').addEventListener('click', async () => {
            const product = document.getElementById('product').value;
            const amount = document.getElementById('amount').value;

            if (!product || !amount) {
                alert('Veuillez remplir tous les champs');
                return;
            }

            const accounts = await window.web3.eth.getAccounts();
            const toAddress = 'VOTRE_ADRESSE_ETH';

            try {
                await window.web3.eth.sendTransaction({
                    from: accounts[0],
                    to: toAddress,
                    value: window.web3.utils.toWei(amount, 'ether')
                });
                alert('Paiement effectué avec succès');
                // Envoyer les détails de la commande par email ou enregistrer dans une base de données
            } catch (error) {
                console.error(error);
                alert('Erreur lors du paiement');
            }
        });
    </script>
</body>
</html>
